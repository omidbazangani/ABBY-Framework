Code from https://cr.yp.to/chacha.html